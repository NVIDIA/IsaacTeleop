import{expose,transfer}from"comlink";var createMSDFGenModule=(()=>{var t=import.meta.url;return function(e={}){var r,n,a,i=e,o=new Promise((t,e)=>{r=t,n=e}),s=Object.assign({},i),u="";"undefined"!=typeof document&&document.currentScript&&(u=document.currentScript.src),t&&(u=t),u=u.startsWith("blob:")?"":u.substr(0,u.replace(/[?#].*/,"").lastIndexOf("/")+1),a=async t=>{if((t=await fetch(t,{credentials:"same-origin"})).ok)return t.arrayBuffer();throw Error(t.status+" : "+t.url)};var l=i.print||console.log.bind(console),h=i.printErr||console.error.bind(console);Object.assign(i,s),s=null;var f,c,d,p,m,w,v,y,g,b,I=i.wasmBinary,$=!1;function S(){var t=f.buffer;i.HEAP8=d=new Int8Array(t),i.HEAP16=m=new Int16Array(t),i.HEAPU8=p=new Uint8Array(t),i.HEAPU16=w=new Uint16Array(t),i.HEAP32=v=new Int32Array(t),i.HEAPU32=y=new Uint32Array(t),i.HEAPF32=g=new Float32Array(t),i.HEAPF64=b=new Float64Array(t)}var A=[],T=[],C=[];function P(){var t=i.preRun.shift();A.unshift(t)}var W=0,F=null;function O(t){throw i.onAbort?.(t),h(t="Aborted("+t+")"),$=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),n(t),t}var M,E=t=>t.startsWith("data:application/octet-stream;base64,");class x{name="ExitStatus";constructor(t){this.message=`Program terminated with exit(${t})`,this.status=t}}var R=t=>{for(;0<t.length;)t.shift()(i)},k=i.noExitRuntime||!0;class j{constructor(t){this.K=t-24}}var J={},U=t=>{for(;t.length;){var e=t.pop();t.pop()(e)}};function z(t){return this.fromWireType(y[t>>2])}var K,N,L,_={},D={},V={},H=(t,e,r)=>{function n(e){if((e=r(e)).length!==t.length)throw new K("Mismatched type converter count");for(var n=0;n<t.length;++n)Z(t[n],e[n])}t.forEach(t=>V[t]=e);var a=Array(e.length),i=[],o=0;e.forEach((t,e)=>{D.hasOwnProperty(t)?a[e]=D[t]:(i.push(t),_.hasOwnProperty(t)||(_[t]=[]),_[t].push(()=>{a[e]=D[t],++o===i.length&&n(a)}))}),0===i.length&&n(a)},B=t=>{for(var e="";p[t];)e+=N[p[t++]];return e},G=t=>{throw new L(t)};function Z(t,e,r={}){return function(t,e,r={}){var n=e.name;if(!t)throw new L(`type "${n}" must have a positive integer typeid pointer`);if(D.hasOwnProperty(t)){if(r.pa)return;throw new L(`Cannot register type '${n}' twice`)}D[t]=e,delete V[t],_.hasOwnProperty(t)&&(e=_[t],delete _[t],e.forEach(t=>t()))}(t,e,r)}var X=t=>{throw new L(t.I.L.J.name+" instance already deleted")},Y=!1,q=()=>{},Q=(t,e,r)=>e===r?t:void 0===r.N||null===(t=Q(t,e,r.N))?null:r.ia(t),tt={},et={},rt=(t,e)=>{if(!e.L||!e.K)throw new K("makeClassHandle requires ptr and ptrType");if(!!e.O!=!!e.M)throw new K("Both smartPtrType and smartPtr must be specified");return e.count={value:1},nt(Object.create(t,{I:{value:e,writable:!0}}))},nt=t=>"undefined"==typeof FinalizationRegistry?(nt=t=>t,t):(Y=new FinalizationRegistry(t=>{--(t=t.I).count.value,0===t.count.value&&(t.M?t.O.R(t.M):t.L.J.R(t.K))}),q=t=>{Y.unregister(t)},(nt=t=>{var e=t.I;return e.M&&Y.register(t,{I:e},t),t})(t)),at=[];function it(){}var ot=(t,e)=>Object.defineProperty(e,"name",{value:t}),st=(t,e,r)=>{if(void 0===t[e].T){var n=t[e];t[e]=function(...n){if(!t[e].T.hasOwnProperty(n.length))throw new L(`Function '${r}' called with an invalid number of arguments (${n.length}) - expects one of (${t[e].T})!`);return t[e].T[n.length].apply(this,n)},t[e].T=[],t[e].T[n.W]=n}};function ut(t,e,r,n,a,i,o,s){this.name=t,this.constructor=e,this.V=r,this.R=n,this.N=a,this.ka=i,this.Z=o,this.ia=s,this.ra=[]}var lt=(t,e,r)=>{for(;e!==r;){if(!e.Z)throw new L(`Expected null or instance of ${r.name}, got an instance of ${e.name}`);t=e.Z(t),e=e.N}return t};function ht(t,e){if(null===e){if(this.ba)throw new L(`null is not a valid ${this.name}`);return 0}if(!e.I)throw new L(`Cannot pass "${Wt(e)}" as a ${this.name}`);if(!e.I.K)throw new L(`Cannot pass deleted object as a pointer of type ${this.name}`);return lt(e.I.K,e.I.L.J,this.J)}function ft(t,e){if(null===e){if(this.ba)throw new L(`null is not a valid ${this.name}`);if(this.aa){var r=this.ca();return null!==t&&t.push(this.R,r),r}return 0}if(!e||!e.I)throw new L(`Cannot pass "${Wt(e)}" as a ${this.name}`);if(!e.I.K)throw new L(`Cannot pass deleted object as a pointer of type ${this.name}`);if(!this.$&&e.I.L.$)throw new L(`Cannot convert argument of type ${e.I.O?e.I.O.name:e.I.L.name} to parameter type ${this.name}`);if(r=lt(e.I.K,e.I.L.J,this.J),this.aa){if(void 0===e.I.M)throw new L("Passing raw pointer to smart pointer is illegal");switch(this.wa){case 0:if(e.I.O!==this)throw new L(`Cannot convert argument of type ${e.I.O?e.I.O.name:e.I.L.name} to parameter type ${this.name}`);r=e.I.M;break;case 1:r=e.I.M;break;case 2:if(e.I.O===this)r=e.I.M;else{var n=e.clone();r=this.sa(r,Ct(()=>n.delete())),null!==t&&t.push(this.R,r)}break;default:throw new L("Unsupporting sharing policy")}}return r}function ct(t,e){if(null===e){if(this.ba)throw new L(`null is not a valid ${this.name}`);return 0}if(!e.I)throw new L(`Cannot pass "${Wt(e)}" as a ${this.name}`);if(!e.I.K)throw new L(`Cannot pass deleted object as a pointer of type ${this.name}`);if(e.I.L.$)throw new L(`Cannot convert argument of type ${e.I.L.name} to parameter type ${this.name}`);return lt(e.I.K,e.I.L.J,this.J)}function dt(t,e,r,n,a,i,o,s,u,l,h){this.name=t,this.J=e,this.ba=r,this.$=n,this.aa=a,this.qa=i,this.wa=o,this.ga=s,this.ca=u,this.sa=l,this.R=h,a||void 0!==e.N?this.toWireType=ft:(this.toWireType=n?ht:ct,this.P=null)}var pt,mt,wt=(t,e)=>{var r=(t=B(t)).includes("j")?((t,e)=>(...r)=>((t,e,r=[])=>(t.includes("j")?(t=t.replace(/p/g,"i"),e=(0,i["dynCall_"+t])(e,...r)):e=pt.get(e)(...r),e))(t,e,r))(t,e):pt.get(e);if("function"!=typeof r)throw new L(`unknown function pointer with signature ${t}: ${e}`);return r},vt=t=>{t=Yt(t);var e=B(t);return Qt(t),e},yt=(t,e)=>{var r=[],n={};throw e.forEach(function t(e){n[e]||D[e]||(V[e]?V[e].forEach(t):(r.push(e),n[e]=!0))}),new mt(`${t}: `+r.map(vt).join([", "]))},gt=(t,e)=>{for(var r=[],n=0;n<t;n++)r.push(y[e+4*n>>2]);return r};function bt(t){for(var e=1;e<t.length;++e)if(null!==t[e]&&void 0===t[e].P)return!0;return!1}function It(t,e,r,n,a,i){var o=e.length;if(2>o)throw new L("argTypes array size mismatch! Must at least get return value and 'this' types!");var s=null!==e[1]&&null!==r,u=bt(e);for(r="void"!==e[0].name,n=[t,G,n,a,U,e[0],e[1]],a=0;a<o-2;++a)n.push(e[a+2]);if(!u)for(a=s?1:2;a<e.length;++a)null!==e[a].P&&n.push(e[a].P);u=bt(e),a=e.length-2;var l=[],h=["fn"];for(s&&h.push("thisWired"),o=0;o<a;++o)l.push(`arg${o}`),h.push(`arg${o}Wired`);l=l.join(","),h=h.join(","),l=`return function (${l}) {\n`,u&&(l+="var destructors = [];\n");var f=u?"destructors":"null",c="humanName throwBindingError invoker fn runDestructors retType classParam".split(" ");for(s&&(l+=`var thisWired = classParam['toWireType'](${f}, this);\n`),o=0;o<a;++o)l+=`var arg${o}Wired = argType${o}['toWireType'](${f}, arg${o});\n`,c.push(`argType${o}`);if(l+=(r||i?"var rv = ":"")+`invoker(${h});\n`,u)l+="runDestructors(destructors);\n";else for(o=s?1:2;o<e.length;++o)i=1===o?"thisWired":"arg"+(o-2)+"Wired",null!==e[o].P&&(l+=`${i}_dtor(${i});\n`,c.push(`${i}_dtor`));r&&(l+="var ret = retType['fromWireType'](rv);\nreturn ret;\n");let[d,p]=[c,l+"}\n"];return d.push(p),e=function(t){var e=Function;if(!(e instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof e} which is not a function`);var r=ot(e.name||"unknownFunctionName",function(){});return r.prototype=e.prototype,r=new r,(t=e.apply(r,t))instanceof Object?t:r}(d)(...n),ot(t,e)}var $t,St,At=[],Tt=[],Ct=t=>{switch(t){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:const e=At.pop()||Tt.length;return Tt[e]=t,Tt[e+1]=1,e}},Pt={name:"emscripten::val",fromWireType:t=>{if(!t)throw new L("Cannot use deleted val. handle = "+t);var e=Tt[t];return 9<t&&0===--Tt[t+1]&&(Tt[t]=void 0,At.push(t)),e},toWireType:(t,e)=>Ct(e),S:8,readValueFromPointer:z,P:null},Wt=t=>{if(null===t)return"null";var e=typeof t;return"object"===e||"array"===e||"function"===e?t.toString():""+t},Ft=(t,e)=>{switch(e){case 4:return function(t){return this.fromWireType(g[t>>2])};case 8:return function(t){return this.fromWireType(b[t>>3])};default:throw new TypeError(`invalid float width (${e}): ${t}`)}},Ot=(t,e,r)=>{switch(e){case 1:return r?t=>d[t]:t=>p[t];case 2:return r?t=>m[t>>1]:t=>w[t>>1];case 4:return r?t=>v[t>>2]:t=>y[t>>2];default:throw new TypeError(`invalid integer width (${e}): ${t}`)}},Mt=Object.assign({optional:!0},Pt),Et="undefined"!=typeof TextDecoder?new TextDecoder:void 0,xt=(t,e=0,r=NaN)=>{var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.buffer&&Et)return Et.decode(t.subarray(e,r));for(n="";e<r;){var a=t[e++];if(128&a){var i=63&t[e++];if(192==(224&a))n+=String.fromCharCode((31&a)<<6|i);else{var o=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|i<<6|o:(7&a)<<18|i<<12|o<<6|63&t[e++])?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else n+=String.fromCharCode(a)}return n},Rt="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0,kt=(t,e)=>{for(var r=t>>1,n=r+e/2;!(r>=n)&&w[r];)++r;if(32<(r<<=1)-t&&Rt)return Rt.decode(p.subarray(t,r));for(r="",n=0;!(n>=e/2);++n){var a=m[t+2*n>>1];if(0==a)break;r+=String.fromCharCode(a)}return r},jt=(t,e,r)=>{if(r??=2147483647,2>r)return 0;var n=e;r=(r-=2)<2*t.length?r/2:t.length;for(var a=0;a<r;++a)m[e>>1]=t.charCodeAt(a),e+=2;return m[e>>1]=0,e-n},Jt=t=>2*t.length,Ut=(t,e)=>{for(var r=0,n="";!(r>=e/4);){var a=v[t+4*r>>2];if(0==a)break;++r,65536<=a?(a-=65536,n+=String.fromCharCode(55296|a>>10,56320|1023&a)):n+=String.fromCharCode(a)}return n},zt=(t,e,r)=>{if(r??=2147483647,4>r)return 0;var n=e;r=n+r-4;for(var a=0;a<t.length;++a){var i=t.charCodeAt(a);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++a)),v[e>>2]=i,(e+=4)+4>r)break}return v[e>>2]=0,e-n},Kt=t=>{for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);55296<=n&&57343>=n&&++r,e+=4}return e},Nt=0,Lt={},_t=t=>{if(!(t instanceof x||"unwind"==t))throw t},Dt=t=>{throw c=t,k||0<Nt||(i.onExit?.(t),$=!0),new x(t)},Vt=[null,[],[]];K=i.InternalError=class extends Error{constructor(t){super(t),this.name="InternalError"}};for(var Ht=Array(256),Bt=0;256>Bt;++Bt)Ht[Bt]=String.fromCharCode(Bt);N=Ht,L=i.BindingError=class extends Error{constructor(t){super(t),this.name="BindingError"}},Object.assign(it.prototype,{isAliasOf:function(t){if(!(this instanceof it&&t instanceof it))return!1;var e=this.I.L.J,r=this.I.K;t.I=t.I;var n=t.I.L.J;for(t=t.I.K;e.N;)r=e.Z(r),e=e.N;for(;n.N;)t=n.Z(t),n=n.N;return e===n&&r===t},clone:function(){if(this.I.K||X(this),this.I.Y)return this.I.count.value+=1,this;var t=nt,e=Object,r=e.create,n=Object.getPrototypeOf(this),a=this.I;return(t=t(r.call(e,n,{I:{value:{count:a.count,X:a.X,Y:a.Y,K:a.K,L:a.L,M:a.M,O:a.O}}}))).I.count.value+=1,t.I.X=!1,t},delete(){if(this.I.K||X(this),this.I.X&&!this.I.Y)throw new L("Object already scheduled for deletion");q(this);var t=this.I;--t.count.value,0===t.count.value&&(t.M?t.O.R(t.M):t.L.J.R(t.K)),this.I.Y||(this.I.M=void 0,this.I.K=void 0)},isDeleted:function(){return!this.I.K},deleteLater:function(){if(this.I.K||X(this),this.I.X&&!this.I.Y)throw new L("Object already scheduled for deletion");return at.push(this),this.I.X=!0,this}}),Object.assign(dt.prototype,{la(t){return this.ga&&(t=this.ga(t)),t},ea(t){this.R?.(t)},S:8,readValueFromPointer:z,fromWireType:function(t){function e(){return this.aa?rt(this.J.V,{L:this.qa,K:r,O:this,M:t}):rt(this.J.V,{L:this,K:t})}var r=this.la(t);if(!r)return this.ea(t),null;var n=((t,e)=>{if(void 0===e)throw new L("ptr should not be undefined");for(;t.N;)e=t.Z(e),t=t.N;return et[e]})(this.J,r);if(void 0!==n)return 0===n.I.count.value?(n.I.K=r,n.I.M=t,n.clone()):(n=n.clone(),this.ea(t),n);if(n=this.J.ka(r),!(n=tt[n]))return e.call(this);n=this.$?n.ha:n.pointerType;var a=Q(r,this.J,n.J);return null===a?e.call(this):this.aa?rt(n.J.V,{L:n,K:a,O:this,M:t}):rt(n.J.V,{L:n,K:a})}}),mt=i.UnboundTypeError=($t=Error,(St=ot("UnboundTypeError",function(t){this.name="UnboundTypeError",this.message=t,void 0!==(t=Error(t).stack)&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))})).prototype=Object.create($t.prototype),St.prototype.constructor=St,St.prototype.toString=function(){return void 0===this.message?this.name:`${this.name}: ${this.message}`},St),Tt.push(0,1,void 0,1,null,1,!0,1,!1,1),i.count_emval_handles=()=>Tt.length/2-5-At.length;var Gt,Zt={h:(t,e,r)=>{var n=new j(t);throw y[n.K+16>>2]=0,y[n.K+4>>2]=e,y[n.K+8>>2]=r,t},w:()=>O(""),e:t=>{var e=J[t];delete J[t];var r=e.ca,n=e.R,a=e.fa,i=a.map(t=>t.oa).concat(a.map(t=>t.ua));H([t],i,t=>{var i={};return a.forEach((e,r)=>{var n=t[r],o=e.ma,s=e.na,u=t[r+a.length],l=e.ta,h=e.va;i[e.ja]={read:t=>n.fromWireType(o(s,t)),write:(t,e)=>{var r=[];l(h,t,u.toWireType(r,e)),U(r)}}}),[{name:e.name,fromWireType:t=>{var e,r={};for(e in i)r[e]=i[e].read(t);return n(t),r},toWireType:(t,e)=>{for(var a in i)if(!(a in e))throw new TypeError(`Missing field: "${a}"`);var o=r();for(a in i)i[a].write(o,e[a]);return null!==t&&t.push(n,o),o},S:8,readValueFromPointer:z,P:n}]})},p:()=>{},z:(t,e,r,n)=>{Z(t,{name:e=B(e),fromWireType:function(t){return!!t},toWireType:function(t,e){return e?r:n},S:8,readValueFromPointer:function(t){return this.fromWireType(p[t])},P:null})},j:(t,e,r,n,a,o,s,u,l,h,f,c,d)=>{f=B(f),o=wt(a,o),u&&=wt(s,u),h&&=wt(l,h),d=wt(c,d);var p=(t=>{var e=(t=t.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=e&&57>=e?`_${t}`:t})(f);(t=>{if(i.hasOwnProperty(t))throw new L(`Cannot register public name '${t}' twice`);i[t]=function(){yt(`Cannot construct ${f} due to unbound types`,[n])},i[t].W=void 0})(p),H([t,e,r],n?[n]:[],e=>{if(e=e[0],n)var r=e.J,a=r.V;else a=it.prototype;e=ot(f,function(...t){if(Object.getPrototypeOf(this)!==s)throw new L("Use 'new' to construct "+f);if(void 0===c.U)throw new L(f+" has no accessible constructor");var e=c.U[t.length];if(void 0===e)throw new L(`Tried to invoke ctor of ${f} with invalid number of parameters (${t.length}) - expected (${Object.keys(c.U).toString()}) parameters instead!`);return e.apply(this,t)});var s=Object.create(a,{constructor:{value:e}});e.prototype=s;var l,c=new ut(f,e,s,d,r,o,u,h);return c.N&&((l=c.N).da??(l.da=[]),c.N.da.push(c)),r=new dt(f,c,!0,!1,!1),l=new dt(f+"*",c,!1,!1,!1),a=new dt(f+" const*",c,!1,!0,!1),tt[t]={pointerType:l,ha:a},((t,e)=>{if(!i.hasOwnProperty(t))throw new K("Replacing nonexistent public symbol");i[t]=e,i[t].W=void 0})(p,e),[r,l,a]})},i:(t,e,r,n,a,i)=>{var o=gt(e,r);a=wt(n,a),H([],[t],t=>{var r=`constructor ${(t=t[0]).name}`;if(void 0===t.J.U&&(t.J.U=[]),void 0!==t.J.U[e-1])throw new L(`Cannot register multiple constructors with identical number of parameters (${e-1}) for class '${t.name}'! Overload resolution is currently only performed using the parameter count, not actual type info!`);return t.J.U[e-1]=()=>{yt(`Cannot construct ${t.name} due to unbound types`,o)},H([],o,n=>(n.splice(1,0,null),t.J.U[e-1]=It(r,n,null,a,i),[])),[]})},c:(t,e,r,n,a,i,o,s,u)=>{var l=gt(r,n);e=(t=>{const e=(t=t.trim()).indexOf("(");return-1!==e?t.substr(0,e):t})(e=B(e)),i=wt(a,i),H([],[t],t=>{function n(){yt(`Cannot call ${a} due to unbound types`,l)}var a=`${(t=t[0]).name}.${e}`;e.startsWith("@@")&&(e=Symbol[e.substring(2)]),s&&t.J.ra.push(e);var h=t.J.V,f=h[e];return void 0===f||void 0===f.T&&f.className!==t.name&&f.W===r-2?(n.W=r-2,n.className=t.name,h[e]=n):(st(h,e,a),h[e].T[r-2]=n),H([],l,n=>(n=It(a,n,t,i,o,u),void 0===h[e].T?(n.W=r-2,h[e]=n):h[e].T[r-2]=n,[])),[]})},x:t=>Z(t,Pt),k:(t,e,r)=>{Z(t,{name:e=B(e),fromWireType:t=>t,toWireType:(t,e)=>e,S:8,readValueFromPointer:Ft(e,r),P:null})},d:(t,e,r,n,a)=>{if(e=B(e),-1===a&&(a=4294967295),a=t=>t,0===n){var i=32-8*r;a=t=>t<<i>>>i}var o=e.includes("unsigned")?function(t,e){return e>>>0}:function(t,e){return e};Z(t,{name:e,fromWireType:a,toWireType:o,S:8,readValueFromPointer:Ot(e,r,0!==n),P:null})},a:(t,e,r)=>{function n(t){return new a(d.buffer,y[t+4>>2],y[t>>2])}var a=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][e];Z(t,{name:r=B(r),fromWireType:n,S:8,readValueFromPointer:n},{pa:!0})},n:t=>{Z(t,Mt)},y:(t,e)=>{Z(t,{name:e=B(e),fromWireType:function(t){for(var e,r=y[t>>2],n=t+4,a=n,i=0;i<=r;++i){var o=n+i;i!=r&&0!=p[o]||(a=a?xt(p,a,o-a):"",void 0===e?e=a:(e+=String.fromCharCode(0),e+=a),a=o+1)}return Qt(t),e},toWireType:function(t,e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var r,n,a="string"==typeof e;if(!(a||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int8Array))throw new L("Cannot pass non-string to std::string");if(a)for(r=n=0;r<e.length;++r){var i=e.charCodeAt(r);127>=i?n++:2047>=i?n+=2:55296<=i&&57343>=i?(n+=4,++r):n+=3}else n=e.length;if(i=(n=qt(4+(r=n)+1))+4,y[n>>2]=r,a){if(a=i,i=r+1,r=p,0<i){i=a+i-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),127>=s){if(a>=i)break;r[a++]=s}else{if(2047>=s){if(a+1>=i)break;r[a++]=192|s>>6}else{if(65535>=s){if(a+2>=i)break;r[a++]=224|s>>12}else{if(a+3>=i)break;r[a++]=240|s>>18,r[a++]=128|s>>12&63}r[a++]=128|s>>6&63}r[a++]=128|63&s}}r[a]=0}}else if(a)for(a=0;a<r;++a){if(255<(o=e.charCodeAt(a)))throw Qt(i),new L("String has UTF-16 code units that do not fit in 8 bits");p[i+a]=o}else for(a=0;a<r;++a)p[i+a]=e[a];return null!==t&&t.push(Qt,n),n},S:8,readValueFromPointer:z,P(t){Qt(t)}})},g:(t,e,r)=>{if(r=B(r),2===e)var n=kt,a=jt,i=Jt,o=t=>w[t>>1];else 4===e&&(n=Ut,a=zt,i=Kt,o=t=>y[t>>2]);Z(t,{name:r,fromWireType:t=>{for(var r,a=y[t>>2],i=t+4,s=0;s<=a;++s){var u=t+4+s*e;s!=a&&0!=o(u)||(i=n(i,u-i),void 0===r?r=i:(r+=String.fromCharCode(0),r+=i),i=u+e)}return Qt(t),r},toWireType:(t,n)=>{if("string"!=typeof n)throw new L(`Cannot pass non-string to C++ string type ${r}`);var o=i(n),s=qt(4+o+e);return y[s>>2]=o/e,a(n,s+4,o+e),null!==t&&t.push(Qt,s),s},S:8,readValueFromPointer:z,P(t){Qt(t)}})},f:(t,e,r,n,a,i)=>{J[t]={name:B(e),ca:wt(r,n),R:wt(a,i),fa:[]}},b:(t,e,r,n,a,i,o,s,u,l)=>{J[t].fa.push({ja:B(e),oa:r,ma:wt(n,a),na:i,ua:o,ta:wt(s,u),va:l})},l:(t,e)=>{Z(t,{xa:!0,name:e=B(e),S:0,fromWireType:()=>{},toWireType:()=>{}})},r:()=>{k=!1,Nt=0},m:(t,e)=>{var r=D[t];if(void 0===r)throw t=`_emval_take_value has unknown type ${vt(t)}`,new L(t);return t=(t=r).readValueFromPointer(e),Ct(t)},s:(t,e)=>{if(Lt[t]&&(clearTimeout(Lt[t].id),delete Lt[t]),!e)return 0;var r=setTimeout(()=>{delete Lt[t],(t=>{if(!$)try{if(t(),!(k||0<Nt))try{c=t=c,Dt(t)}catch(t){_t(t)}}catch(t){_t(t)}})(()=>te(t,performance.now()))},e);return Lt[t]={id:r,ya:e},0},t:t=>{var e=p.length;if(2147483648<(t>>>=0))return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296);t:{n=(Math.min(2147483648,65536*Math.ceil(Math.max(t,n)/65536))-f.buffer.byteLength+65535)/65536|0;try{f.grow(n),S();var a=1;break t}catch(t){}a=void 0}if(a)return!0}return!1},v:()=>52,o:function(){return 70},u:(t,e,r,n)=>{for(var a=0,i=0;i<r;i++){var o=y[e>>2],s=y[e+4>>2];e+=8;for(var u=0;u<s;u++){var f=p[o+u],c=Vt[t];0===f||10===f?((1===t?l:h)(xt(c)),c.length=0):c.push(f)}a+=s}return y[n>>2]=a,0},q:Dt};!async function(){function t(t){return Gt=t.exports,f=Gt.A,S(),pt=Gt.D,T.unshift(Gt.B),W--,i.monitorRunDependencies?.(W),0==W&&F&&(t=F,F=null,t()),Gt}W++,i.monitorRunDependencies?.(W);var e={a:Zt};if(i.instantiateWasm)try{return i.instantiateWasm(e,t)}catch(t){h(`Module.instantiateWasm callback failed with error: ${t}`),n(t)}M??=i.locateFile?E("msdfgen_wasm.wasm")?"msdfgen_wasm.wasm":i.locateFile?i.locateFile("msdfgen_wasm.wasm",u):u+"msdfgen_wasm.wasm":new URL("msdfgen_wasm.wasm",import.meta.url).href;try{var r=await async function(t){var e=M;if(!I&&"function"==typeof WebAssembly.instantiateStreaming&&!E(e)&&"function"==typeof fetch)try{var r=fetch(e,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(r,t)}catch(t){h(`wasm streaming compile failed: ${t}`),h("falling back to ArrayBuffer instantiation")}return async function(t,e){try{var r=await async function(t){if(!I)try{var e=await a(t);return new Uint8Array(e)}catch{}if(t!=M||!I)throw"both async and sync fetching of the wasm failed";return new Uint8Array(I)}(t);return await WebAssembly.instantiate(r,e)}catch(t){h(`failed to asynchronously prepare wasm: ${t}`),O(t)}}(e,t)}(e);return t(r.instance),r}catch(t){n(t)}}();var Xt,Yt=t=>(Yt=Gt.C)(t),qt=t=>(qt=Gt.E)(t),Qt=t=>(Qt=Gt.F)(t),te=(t,e)=>(te=Gt.G)(t,e);function ee(){function t(){if(!Xt&&(Xt=!0,i.calledRun=!0,!$)){if(R(T),r(i),i.onRuntimeInitialized?.(),i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;){var t=i.postRun.shift();C.unshift(t)}R(C)}}if(!(0<W)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)P();R(A),0<W||(i.setStatus?(i.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>i.setStatus(""),1),t()},1)):t())}}if(i.dynCall_jiji=(t,e,r,n,a)=>(i.dynCall_jiji=Gt.H)(t,e,r,n,a),F=function t(){Xt||ee(),Xt||(F=t)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();return ee(),o}})(),msdfgen_wasm_default=createMSDFGenModule,MSDFGenerator=class{module;font=null;constructor(t){this.module=t}async loadFont(t){this.font=new this.module.Font;const e=new this.module.VectorUnsignedChar;for(let r=0;r<t.length;r++)e.push_back(t[r]);const r=this.font.loadFromMemory(e);if(e.delete(),!r)throw new Error("Failed to load font from memory")}generateAtlas(t){if(!this.font)throw new Error("No font loaded");const{charset:e,fontSize:r=48,textureSize:n=[512,512],fieldRange:a=4,padding:i=4,fixOverlaps:o=!0}=t,s=this.font.getMetrics(),u=this.getFontProperties(),l=r/s.emSize,h=s.ascender*l,f=Math.floor(a/2),c=Array.from(new Set(e)),d=[];let p=0,m=0,w=0;const v=new Uint8ClampedArray(n[0]*n[1]*4);for(let t=0;t<c.length;t++){const e=c[t],r=e.codePointAt(0),s=this.font.getGlyphShape(r),u=Math.floor(s.left*l),y=Math.floor(s.bottom*l),g=Math.ceil(s.right*l),b=Math.ceil(s.top*l),I=g-u+2*f,$=b-y+2*f;p+I>n[0]&&(p=0,m+=w+i,w=0);const S=s.right-s.left,A=s.top-s.bottom,T=l,C=.5*(I/T-S)-s.left,P=.5*($/T-A)-s.bottom,W=Math.round(P*T)/T,F=o?this.font.generateMSDFWithOverlapFix(r,I,$,a,C,W,T):this.font.generateMSDF(r,I,$,a,C,W,T);for(let t=0;t<$;t++)for(let e=0;e<I;e++){const r=3*(t*I+e),a=4*((m+t)*n[0]+(p+e));v[a+0]=F.data.get(r+0)??0,v[a+1]=F.data.get(r+1)??0,v[a+2]=F.data.get(r+2)??0,v[a+3]=255}F.data.delete(),d.push({unicode:r,char:e,atlasPosition:[p,m],atlasSize:[I,$],bounds:{left:u,bottom:y,right:g,top:b},advance:s.advance*l,xoffset:u-f,yoffset:h-b-f}),p+=I+i,w=Math.max(w,$)}const y=[];for(let t=0;t<c.length;t++)for(let e=0;e<c.length;e++){const r=c[t].codePointAt(0),n=c[e].codePointAt(0),a=this.font.getKerning(r,n)*l;0!==a&&y.push({first:c[t],second:c[e],amount:a})}return{texture:new ImageData(v,n[0],n[1]),glyphs:d,metrics:{emSize:s.emSize,ascender:s.ascender*l,descender:s.descender*l,lineHeight:s.lineHeight*l},info:u,kerning:y,textureSize:n,fieldRange:a}}getFontProperties(){if(!this.font)throw new Error("No font loaded");const t=this.font.getFontProperties();return{...t,name:String(t.name)}}exportJSON(t){const{atlas:e,fontSize:r=48}=t,n=Math.floor(e.fieldRange/2);return{pages:["texture.png"],chars:e.glyphs.map((t,e)=>({id:t.unicode,index:e,char:t.char,width:t.atlasSize[0],height:t.atlasSize[1],xoffset:t.xoffset,yoffset:t.yoffset,xadvance:t.advance,chnl:15,x:t.atlasPosition[0],y:t.atlasPosition[1],page:0})),info:{face:e.info.name,size:r,bold:e.info.bold?1:0,italic:e.info.italic?1:0,charset:e.glyphs.map(t=>t.char),unicode:1,stretchH:100,smooth:1,aa:1,padding:[n,n,n,n],spacing:[0,0],outline:0},common:{lineHeight:e.metrics.lineHeight,base:e.metrics.ascender,scaleW:e.textureSize[0],scaleH:e.textureSize[1],pages:1,packed:0,alphaChnl:0,redChnl:0,greenChnl:0,blueChnl:0},distanceField:{fieldType:"msdf",distanceRange:e.fieldRange},kernings:e.kerning.map(t=>({first:t.first.codePointAt(0),second:t.second.codePointAt(0),amount:t.amount}))}}dispose(){this.font&&(this.font.delete(),this.font=null)}},MSDFGeneratorWorker=class{generator=null;async initialize(t){try{const e=t?{locateFile:e=>e.endsWith(".wasm")?t:e}:void 0,r=await msdfgen_wasm_default(e);this.generator=new MSDFGenerator(r)}catch(t){throw console.error("[MSDF Generator] Failed to initialize worker:",t),t}}ensureInitialized(){if(!this.generator)throw new Error("Worker not initialized. Call initialize() first.");return this.generator}async loadFont(t){await this.ensureInitialized().loadFont(t)}generateAtlas(t){return this.ensureInitialized().generateAtlas({...t,font:new Uint8Array(0)})}exportJSON(t){return this.ensureInitialized().exportJSON(t)}dispose(){this.generator?.dispose(),this.generator=null}async generateMSDFAtlas(t){this.ensureInitialized(),await this.loadFont(t.font);const e=this.generateAtlas(t);return transfer(e,[e.texture.data.buffer])}async generateMSDFFont(t){this.ensureInitialized(),await this.loadFont(t.font);const e=this.generateAtlas(t);return this.exportJSON({atlas:e,fontSize:t.fontSize||48})}};expose(new MSDFGeneratorWorker);